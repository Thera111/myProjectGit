# 性能测试快速参考

## 📋 文件清单

本项目提供以下性能测试相关文件：

| 文件名 | 类型 | 用途 |
|-------|------|------|
| `performance_test.sh` | 脚本 | 自动化性能测试执行脚本 |
| `性能测试指南.md` | 文档 | 详细的测试方法和报告撰写指导 |
| `性能测试报告模板.md` | 模板 | 标准化的性能测试报告模板 |
| `性能测试报告.md` | 示例 | 完整的性能测试报告示例 |
| `performance_tests/` | 目录 | 测试数据、结果和日志存放目录 |
| `性能测试快速参考.md` | 参考 | 本文件，快速使用指南 |

---

## 🚀 快速开始

### 第一步：运行性能测试

```bash
# 在项目根目录执行
bash performance_test.sh
```

脚本会自动完成：
- ✅ 编译程序
- ✅ 生成测试数据（小、中、大三种规模）
- ✅ 运行性能测试
- ✅ 收集性能指标
- ✅ 生成总结报告

### 第二步：查看测试结果

```bash
# 查看自动生成的总结报告
cat performance_tests/results/performance_summary.md

# 查看详细的示例报告
cat 性能测试报告.md
```

### 第三步：撰写自己的测试报告

1. 复制模板文件：
   ```bash
   cp 性能测试报告模板.md 我的性能测试报告.md
   ```

2. 参考指南文档：
   ```bash
   # 使用文本编辑器打开指南
   cat 性能测试指南.md
   ```

3. 参考示例报告，填写模板中的各个部分

---

## 📚 文档使用指南

### 性能测试指南.md

**适用场景**：
- ✅ 第一次进行性能测试
- ✅ 不清楚如何测量性能指标
- ✅ 需要了解如何撰写测试报告

**主要内容**：
1. 测试目标和策略
2. 测试环境准备
3. 测试数据生成方法
4. 性能指标详解（时间、内存、吞吐量、延迟）
5. 如何进行性能测试（4种方法）
6. 结果分析方法
7. 如何撰写测试报告

**使用提示**：
- 📖 按章节顺序阅读
- 🔍 查找需要的具体测试方法
- 💡 参考附录中的常用命令

### 性能测试报告模板.md

**适用场景**：
- ✅ 需要撰写标准化的性能测试报告
- ✅ 确保报告包含所有必需内容

**使用方法**：
1. 复制模板文件
2. 搜索所有 `[填写]` 标记，替换为实际内容
3. 删除所有 `> **填写说明**:` 的提示文字
4. 根据实际情况调整章节

**包含的章节**：
- ✅ 测试概述
- ✅ 测试环境（必须）
- ✅ 测试数据（必须）
- ✅ 性能测试结果（必须）
- ✅ 时间复杂度分析（必须）
- ✅ 内存占用评估（必须）
- ✅ 吞吐量与延迟评估（必须）
- ✅ 性能瓶颈分析
- ✅ 优化建议
- ✅ 结论与总结

### 性能测试报告.md

**适用场景**：
- ✅ 参考完整报告的格式和内容
- ✅ 了解如何填写各个章节
- ✅ 学习性能分析的方法

**使用方法**：
- 📖 阅读示例，理解报告结构
- 📊 参考图表和表格格式
- 💭 学习分析和结论的撰写方式

**特色**：
- 基于真实测试数据
- 完整的复杂度分析
- 详细的性能瓶颈识别
- 具体的优化建议

---

## 🔧 性能测试脚本使用

### 基本用法

```bash
# 运行完整测试
bash performance_test.sh
```

### 脚本功能

1. **自动编译**：清理并重新编译程序
2. **数据生成**：生成三个规模的测试数据
   - 小规模：100 句
   - 中规模：1000 句
   - 大规模：5000 句
3. **性能测试**：对每个规模运行测试
4. **数据收集**：收集时间、内存、CPU 使用率
5. **报告生成**：自动生成 Markdown 格式的总结报告

### 输出文件

测试完成后，会在 `performance_tests/` 目录下生成：

```
performance_tests/
├── data/                      # 测试数据
│   ├── small.txt             # 100 句
│   ├── medium.txt            # 1000 句
│   └── large.txt             # 5000 句
├── results/                   # 测试结果
│   ├── small_elapsed.txt     # 执行时间
│   ├── small_summary.txt     # 性能汇总
│   ├── small_output.txt      # 程序输出
│   ├── medium_*
│   ├── large_*
│   └── performance_summary.md  # 总结报告
└── logs/                      # 测试日志
    ├── compile.log           # 编译日志
    ├── small_time.log        # 详细性能日志
    ├── medium_time.log
    └── large_time.log
```

### 自定义测试

如需修改测试参数，编辑 `performance_test.sh` 中的以下部分：

```bash
# 修改测试数据规模
generate_test_data "超大规模" "${DATA_DIR}/xlarge.txt" 10000

# 运行自定义测试
run_performance_test "xlarge" "${DATA_DIR}/xlarge.txt" "${RESULTS_DIR}/xlarge_output.txt"
```

---

## 📊 性能指标说明

### 核心指标

| 指标 | 单位 | 说明 | 获取方式 |
|------|------|------|---------|
| **执行时间** | 秒(s) | 程序运行总时间 | 脚本自动测量 |
| **吞吐量** | 句/秒 | 每秒处理的句子数 | 句子数 ÷ 执行时间 |
| **内存占用** | MB | 程序峰值内存 | `/usr/bin/time -v` |
| **CPU使用率** | % | CPU 利用率 | `/usr/bin/time -v` |

### 复杂度分析

需要分析的复杂度：

- **时间复杂度**：各操作的理论时间复杂度（O 表示法）
- **空间复杂度**：各数据结构的内存占用（O 表示法）
- **实验验证**：通过测试数据验证理论分析

### 延迟分析

需要测量的延迟：

- **平均延迟**：所有操作的平均响应时间
- **P95 延迟**：95% 的操作响应时间
- **P99 延迟**：99% 的操作响应时间
- **最大延迟**：最慢的操作响应时间

---

## ✅ 报告撰写检查清单

在提交报告前，确保包含以下内容：

### 必需内容（❌ 缺一不可）

- [ ] 测试环境（硬件、软件、配置）
- [ ] 数据生成方式（方法、规模、特征）
- [ ] 性能测试结果表格（时间、内存、吞吐量）
- [ ] 时间复杂度分析（理论 + 实验验证）
- [ ] 内存占用评估（理论估算 + 实际测量）
- [ ] 吞吐量与延迟评估（不同输入速率）

### 推荐内容（✨ 加分项）

- [ ] 性能趋势图表（吞吐量、内存占用）
- [ ] 性能瓶颈分析（热点函数、资源使用）
- [ ] 优化建议（短期、中期、长期）
- [ ] 复杂度实验验证（数据与理论对比）
- [ ] 延迟分布（P50/P95/P99）

### 格式要求

- [ ] 使用 Markdown 格式
- [ ] 表格对齐整齐
- [ ] 数据真实准确
- [ ] 结论有理有据
- [ ] 删除所有填写提示

---

## 🎯 常见问题

### Q1: 如何运行性能测试？

**A**: 在项目根目录执行：
```bash
bash performance_test.sh
```

### Q2: 测试需要多长时间？

**A**: 通常 1-2 分钟即可完成所有测试（小、中、大三个规模）。

### Q3: 如何查看测试结果？

**A**: 查看自动生成的报告：
```bash
cat performance_tests/results/performance_summary.md
```

### Q4: 如何撰写自己的测试报告？

**A**: 
1. 复制模板：`cp 性能测试报告模板.md 我的报告.md`
2. 参考指南：阅读 `性能测试指南.md`
3. 参考示例：查看 `性能测试报告.md`
4. 填写模板：替换所有 `[填写]` 标记

### Q5: 测试数据可以自定义吗？

**A**: 可以。编辑 `performance_test.sh` 中的 `generate_test_data` 函数，或者手动创建测试文件。

### Q6: 如何清理测试文件？

**A**: 
```bash
# 清理结果和日志（保留测试数据）
rm -rf performance_tests/results/* performance_tests/logs/*

# 清理所有（包括测试数据）
rm -rf performance_tests/data/* performance_tests/results/* performance_tests/logs/*
```

### Q7: 内存测量不准确怎么办？

**A**: 
- 确保使用 `/usr/bin/time -v`（不是 shell 内置的 time）
- 在 macOS 上可能需要安装 GNU time：`brew install gnu-time`

### Q8: 如何生成图表？

**A**: 脚本默认使用文本图表。如需真实图表，可以：
1. 导出数据到 CSV
2. 使用 Python + matplotlib 或 Excel 绘制
3. 参考指南中的示例代码

---

## 📝 总结

### 测试流程

```
1. 运行测试脚本
   ↓
2. 查看自动生成的报告
   ↓
3. 复制报告模板
   ↓
4. 参考指南和示例
   ↓
5. 填写并完善报告
   ↓
6. 检查必需内容
   ↓
7. 提交报告
```

### 关键文件用途

- **指南** → 学习如何测试和撰写报告
- **模板** → 提供标准化的报告结构
- **示例** → 展示完整的报告样式
- **脚本** → 自动化执行测试

### 下一步

1. ✅ 运行 `bash performance_test.sh`
2. ✅ 阅读 `性能测试指南.md`
3. ✅ 查看 `性能测试报告.md` 示例
4. ✅ 使用 `性能测试报告模板.md` 撰写报告

---

**祝测试顺利！**

有问题请参考详细文档或查看示例报告。
